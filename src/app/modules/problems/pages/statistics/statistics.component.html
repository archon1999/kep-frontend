@if (username) {
  <div class="content-wrapper container-xxl p-0">
    <div class="content-body problems-statistics">
      <div class="statistics-header d-flex justify-content-between align-items-center flex-wrap gap-1 mb-1">
        <div>
          <h2 class="mb-0">{{ 'Statistics' | translate }}</h2>
          <div class="text-muted">@{{ username }}</div>
        </div>
      </div>

      @if (isLoading) {
        <kep-card class="mb-1">
          <div class="card-body d-flex justify-content-center align-items-center" [style.minHeight.px]="280">
            <spinner></spinner>
          </div>
        </kep-card>
      } @else if (statistics) {
        <div class="row g-1 mb-1">
          @for (card of overviewCards; track card.titleKey) {
            <div class="col-12 col-sm-6 col-lg-3">
              <kep-card class="overview-card h-100">
                <div class="card-body d-flex align-items-center gap-1">
                  <div class="avatar bg-primary-transparent p-50 m-0">
                    <div class="avatar-content">
                      <kep-icon [name]="card.icon" class="font-medium-2"></kep-icon>
                    </div>
                  </div>
                  <div class="flex-grow-1">
                    <div class="text-uppercase small text-muted fw-bold">{{ card.titleKey | translate }}</div>
                    <div class="fw-bold display-6">
                      @if (card.isNumber) {
                        {{ card.value | number }}
                      } @else {
                        {{ card.value }}
                      }
                    </div>
                    @if (card.subtitle) {
                      <div class="text-muted">{{ card.subtitle }}</div>
                    }
                  </div>
                </div>
              </kep-card>
            </div>
          }
        </div>

        <div class="row g-1">
          <div class="col-xl-4">
            <section-profile
              [username]="username"
              [general]="statistics.general"
              [langs]="statistics.byLang"
              [tags]="statistics.byTag"
              [topics]="statistics.byTopic"
            ></section-profile>
          </div>
          <div class="col-xl-8">
            <div class="row g-1">
              <div class="col-12">
                <section-activity
                  [solved]="statistics.lastDays?.solved ?? 0"
                  [series]="statistics.lastDays?.series ?? []"
                  [selectedDays]="selectedDays ?? statistics.meta?.lastDays ?? 7"
                  [allowedDays]="availableDays?.length ? availableDays : (statistics.meta?.allowedLastDays ?? [7,14,30])"
                  (daysChange)="handleDaysChange($event)"
                ></section-activity>
              </div>
              <div class="col-lg-6">
                <section-difficulties [data]="statistics.byDifficulty"></section-difficulties>
              </div>
              <div class="col-lg-6">
                <section-facts [facts]="statistics.facts"></section-facts>
              </div>
              <div class="col-12">
                <section-heatmap
                  [heatmap]="statistics.heatmap"
                  [selectedYear]="selectedYear"
                  [availableYears]="availableYears"
                  (yearChange)="handleYearChange($event)"
                ></section-heatmap>
              </div>
              <div class="col-12">
                <section-time
                  [byWeekday]="statistics.byWeekday"
                  [byMonth]="statistics.byMonth"
                  [byPeriod]="statistics.byPeriod"
                ></section-time>
              </div>
              <div class="col-12">
                <section-attempts-for-solve
                  [numberOfAttempts]="statistics.numberOfAttempts"
                ></section-attempts-for-solve>
              </div>
            </div>
          </div>
        </div>
      }
    </div>
  </div>
}
